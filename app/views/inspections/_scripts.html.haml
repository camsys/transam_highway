= render partial: 'shared/xeditable_scripts'

:javascript

  // ------ override methods in shared xeditable scripts to handle edit/save buttons in different panels -----------
  function open_tab(tab_id) {
    $('.editableform-loading').hide();
    $('.editableform').show();
    $('#' + tab_id).collapse('show');
  }

  $('.inspection-edit-xeditable-button').on('click', function(e) {
    e.stopPropagation();

    //set selected radios
    selected_radio_inputs = $(this).closest('.panel').find('input[type=radio]:checked');

    var tab_id = $(this).parent().parent().parent().parent().parent().find('.panel-collapse').attr('id');
    enable_tab_editing(tab_id);

    $(this).hide();
    $(this).next('.edit-xeditable-buttons').show();
  });
  // ----------------------------------------------------------------------------------------------------------------

  var user_tab_key = 'inspection_tab_key';

  // Override placement of validator msg on .input-groups
  $.validator.setDefaults({errorPlacement: function(error, element) {
      console.log(element);
      if(element.parents('.input-group').length) {
        error.insertAfter(element.parents('.input-group'));
      } else {
        error.insertAfter(element);
      }
    }
  });

  $(document).ready(function() {

    // transam.make_same_height('.header-part');

    // Manage the tabs
    $('a[data-toggle="tab"]').on('shown.bs.tab', function(e) {
      // save the latest tab
      var this_tab = $(this).attr('href');
      transam.set_ui_key_value(user_tab_key, this_tab);
    });
  });
  $(function() {
    var last_tab = transam.get_ui_key_value(user_tab_key);
    if (last_tab) {
      $('a[href="'+last_tab+'"]').tab('show');
    } else {
      // Default to the first tab if no tab is stored
      $('a[data-toggle="tab"]:first').tab('show');
    }
  });
